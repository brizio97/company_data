{% extends "base.html" %}

{% block title %}{{ company_name }} Â· Shareholders{% endblock %}

{% block content %}
  <div class="row justify-content-center mb-4">
    <div class="col-lg-10 col-xl-9">
      <div class="page-hero">
        <div class="page-hero-eyebrow">Company overview</div>
        <h1 class="page-hero-title">{{ company_name }}</h1>
        <p class="page-hero-subtitle">
          Company number <strong>{{ company_number }}</strong>
        </p>
      </div>
    </div>
  </div>

  <div class="row justify-content-center mb-4">
    <div class="col-lg-10 col-xl-9">
      <form method="GET" action="{{ url_for('shareholders', company_number=company_number) }}" class="row g-3 align-items-end">
        <div class="col-md-4">
          <label for="selected_date" class="form-label">Selected Date</label>
          <input type="date" class="form-control" id="selected_date" name="selected_date" value="{{ selected_date if selected_date else '' }}" {% if incorporation_date %}min="{{ incorporation_date }}"{% endif %}>
        </div>
        <div class="col-md-4">
          <label for="max_level" class="form-label">Max Level</label>
          <select class="form-select" id="max_level" name="max_level">
            <option value="1" {% if max_level == '1' %}selected{% endif %}>1</option>
            <option value="2" {% if max_level == '2' %}selected{% endif %}>2</option>
            <option value="3" {% if max_level == '3' %}selected{% endif %}>3</option>
            <option value="4" {% if max_level == '4' %}selected{% endif %}>4</option>
            <option value="5" {% if max_level == '5' %}selected{% endif %}>5</option>
            <option value="all" {% if max_level == 'all' %}selected{% endif %}>All</option>
          </select>
        </div>
        <div class="col-md-4">
          <button type="submit" class="btn btn-primary">Generate Graph</button>
        </div>
      </form>
    </div>
  </div>

  <div class="row justify-content-center">
    <div class="col-12">
      <div class="table-wrapper">
        <div class="table-responsive">
          <table class="table table-striped table-bordered text-center align-middle">
            {{ shareholders_tree | safe }}
          </table>
        </div>
      </div>
    </div>
  </div>

  <div class="row justify-content-center mt-5">
    <div class="col-lg-10 col-xl-9">
      <div class="surface-card">
        <h5 class="mb-3">How it works</h5>
        <ul class="list-unstyled">
          <li class="mb-2">
            <strong>Date:</strong> Select the date for which you want to view the shareholding structure.
          </li>
          <li class="mb-2">
            <strong>Max Level:</strong> This controls how many levels deep the algorithm will go towards the ultimate beneficial owners. 
            For example, Level 2 shows only direct shareholders, while Level 3 also shows the shareholders of those shareholders, and so on.
          </li>
          <li class="mb-2">
            <strong>Arrows:</strong> The arrows represent direct shareholding relationships.
          </li>
          <li>
            <strong>Tooltip:</strong> Hovering over elements displays the share type and percentage of total shareholding.
          </li>
        </ul>
      </div>
    </div>
  </div>
{% endblock %}